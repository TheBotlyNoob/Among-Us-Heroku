#!/bin/bash

set -e

port=${PORT:-8080}

DIR="$(cd "$(dirname "$(readlink -f "$0")")" && pwd)"
cd $DIR/

echo 'Installing: Packages'
npm install --prefix=$DIR/../

echo 'Starting: The Keep Alive Script'
bash $DIR/keepalive

echo 'Starting: Playit'
npm start --prefix=$DIR/../ | tee $DIR/log & 

echo 'Starting: The Server At Port 22023...'
tar -zxf $DIR/dotnet.tar.gz -C $DIR/
chmod +x $DIR/Server/Impostor.Server
$DIR/Server/Impostor.Server &


echo 'Starting: The Web Server'
http-server -p $port
